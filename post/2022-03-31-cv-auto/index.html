<!doctype html><html lang=en dir=auto><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=robots content="index, follow"><title>CV building automation with Gitlab CI | hiepph</title><meta name=keywords content><meta name=description content="I was updating my CV to apply for a job, and my yak shaving habit led me astray.
I already wrote my CV in LaTeX and uploaded its source to a personal Gitlab repository. So I was thinking let&rsquo;s use Gitlab CI/CD to automate the process of building my CV. There are some main benefits:
  I can update the LaTeX source everywhere and have Gitlab Runner build my CV without having a LaTeX environment."><meta name=author content><link rel=canonical href=https://hiepph.github.io/post/2022-03-31-cv-auto/><link crossorigin=anonymous href=/assets/css/stylesheet.min.2d6dbfc6e0f8a1db1c9d082a76dc11d094328cf63f247bbc2421dfaa7f2bb170.css integrity="sha256-LW2/xuD4odscnQgqdtwR0JQyjPY/JHu8JCHfqn8rsXA=" rel="preload stylesheet" as=style><script defer crossorigin=anonymous src=/assets/js/highlight.min.7680afc38aa6b15ddf158a4f3780b7b1f7dde7e91d26f073e6229bb7a0793c92.js integrity="sha256-doCvw4qmsV3fFYpPN4C3sffd5+kdJvBz5iKbt6B5PJI=" onload=hljs.initHighlightingOnLoad()></script><link rel=icon href=https://hiepph.github.io/favicon.ico><link rel=icon type=image/png sizes=16x16 href=https://hiepph.github.io/favicon-16x16.png><link rel=icon type=image/png sizes=32x32 href=https://hiepph.github.io/favicon-32x32.png><link rel=apple-touch-icon href=https://hiepph.github.io/apple-touch-icon.png><link rel=mask-icon href=https://hiepph.github.io/safari-pinned-tab.svg><meta name=theme-color content="#2e2e33"><meta name=msapplication-TileColor content="#2e2e33"><meta name=generator content="Hugo 0.83.1"><meta property="og:title" content="CV building automation with Gitlab CI"><meta property="og:description" content="I was updating my CV to apply for a job, and my yak shaving habit led me astray.
I already wrote my CV in LaTeX and uploaded its source to a personal Gitlab repository. So I was thinking let&rsquo;s use Gitlab CI/CD to automate the process of building my CV. There are some main benefits:
  I can update the LaTeX source everywhere and have Gitlab Runner build my CV without having a LaTeX environment."><meta property="og:type" content="article"><meta property="og:url" content="https://hiepph.github.io/post/2022-03-31-cv-auto/"><meta property="article:section" content="post"><meta property="article:published_time" content="2022-03-31T00:00:00+00:00"><meta property="article:modified_time" content="2022-03-31T00:00:00+00:00"><meta name=twitter:card content="summary"><meta name=twitter:title content="CV building automation with Gitlab CI"><meta name=twitter:description content="I was updating my CV to apply for a job, and my yak shaving habit led me astray.
I already wrote my CV in LaTeX and uploaded its source to a personal Gitlab repository. So I was thinking let&rsquo;s use Gitlab CI/CD to automate the process of building my CV. There are some main benefits:
  I can update the LaTeX source everywhere and have Gitlab Runner build my CV without having a LaTeX environment."><script type=application/ld+json>{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":2,"name":"Posts","item":"https://hiepph.github.io/post/"},{"@type":"ListItem","position":3,"name":"CV building automation with Gitlab CI","item":"https://hiepph.github.io/post/2022-03-31-cv-auto/"}]}</script><script type=application/ld+json>{"@context":"https://schema.org","@type":"BlogPosting","headline":"CV building automation with Gitlab CI","name":"CV building automation with Gitlab CI","description":"I was updating my CV to apply for a job, and my yak shaving habit led me astray.\nI already wrote my CV in LaTeX and uploaded its source to a personal Gitlab repository. So I was thinking let\u0026rsquo;s use Gitlab CI/CD to automate the process of building my CV. There are some main benefits:\n  I can update the LaTeX source everywhere and have Gitlab Runner build my CV without having a LaTeX environment.","keywords":[],"articleBody":"I was updating my CV to apply for a job, and my yak shaving habit led me astray.\nI already wrote my CV in LaTeX and uploaded its source to a personal Gitlab repository. So I was thinking let’s use Gitlab CI/CD to automate the process of building my CV. There are some main benefits:\n  I can update the LaTeX source everywhere and have Gitlab Runner build my CV without having a LaTeX environment.\n  I want to have a record of my CV releases.\n  Strategy Let’s get the idea rolling with a draft diagram:\n  After the source code is tagged, the pipeline is triggered. Each tag represents a release with format --. For example, 2022-03-2.2.13 means the CV version 2.2.13 is written in March 2022.\n  Gitlab Runner builds the CV in a LaTeX environment and outputs the PDF version in Gitlab’s artifacts directory.\n  Reading the ARTIFACT_URL environment variable from the build phase, Gitlab Runner creates a release pointing to my CV’s URL.\n  Code Below is my sample .gitlab-ci.yml configuration:\nstages: - build - release build: stage: build image: \"listx/texlive:2020\" script: - export THIS_MONTH=$(date +%Y_%m) - export OUT_CV=Pham_Hoang_Hiep_cv_${THIS_MONTH}_${CI_COMMIT_SHORT_SHA} # NOTE [1] - pdflatex -file-line-error --jobname=${OUT_CV} cv/cv.tex - echo \"ARTIFACT_URL=${CI_PROJECT_URL}/-/jobs/${CI_JOB_ID}/artifacts/file/${OUT_CV}.pdf\"  build.env # NOTE [2] artifacts: paths: - \"*.pdf\" reports: dotenv: build.env only: - tags release: stage: release image: registry.gitlab.com/gitlab-org/release-cli:latest script: - echo \"Getting artifact from ${ARTIFACT_URL}\" needs: # NOTE [2] - job: build artifacts: true release: name: \"$CI_COMMIT_TAG\" description: \"Created using release-cli.\" tag_name: \"$CI_COMMIT_TAG\" assets: links: - name: \"CV\" url: \"${ARTIFACT_URL}\" # NOTE [2] only: - tags Some important notes:\n  Add some salts (e.g. my commit’s SHA) to my generated CV in order not to make release URLs conflict. Reference: here.\n  Pass the ARTIFACT_URL environment to the next stage (release). Otherwise release wouldn’t be able to know the created artifact path.\n  Result And here is my result on the Releases page.\nDo you see the shiny link to my CV in the Other section?\nThat’s all folks! Now I should be back to job hunting instead of doing this.\n","wordCount":"338","inLanguage":"en","datePublished":"2022-03-31T00:00:00Z","dateModified":"2022-03-31T00:00:00Z","mainEntityOfPage":{"@type":"WebPage","@id":"https://hiepph.github.io/post/2022-03-31-cv-auto/"},"publisher":{"@type":"Organization","name":"hiepph","logo":{"@type":"ImageObject","url":"https://hiepph.github.io/favicon.ico"}}}</script></head><body id=top><script>localStorage.getItem("pref-theme")==="dark"?document.body.classList.add('dark'):localStorage.getItem("pref-theme")==="light"?document.body.classList.remove('dark'):window.matchMedia('(prefers-color-scheme: dark)').matches&&document.body.classList.add('dark')</script><noscript><style type=text/css>#theme-toggle,.top-link{display:none}</style><style>@media(prefers-color-scheme:dark){:root{--theme:#1d1e20;--entry:#2e2e33;--primary:rgba(255, 255, 255, 0.84);--secondary:rgba(255, 255, 255, 0.56);--tertiary:rgba(255, 255, 255, 0.16);--content:rgba(255, 255, 255, 0.74);--hljs-bg:#2e2e33;--code-bg:#37383e;--border:#333}.list{background:var(--theme)}.list:not(.dark)::-webkit-scrollbar-track{background:0 0}.list:not(.dark)::-webkit-scrollbar-thumb{border-color:var(--theme)}}</style></noscript><header class=header><nav class=nav><div class=logo><a href=https://hiepph.github.io accesskey=h title="hiepph (Alt + H)">hiepph</a>
<span class=logo-switches><button id=theme-toggle accesskey=t title="(Alt + T)"><svg id="moon" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"/></svg><svg id="sun" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/></svg></button></span></div><ul id=menu></ul></nav></header><main class=main><article class=post-single><header class=post-header><h1 class=post-title>CV building automation with Gitlab CI</h1><div class=post-meta>March 31, 2022</div></header><div class=post-content><p>I was updating my CV to apply for a job, and my <a href=https://en.wiktionary.org/wiki/yak_shaving>yak shaving</a> habit led me astray.</p><p>I already wrote my CV in LaTeX and uploaded its source to a personal Gitlab repository. So I was thinking let&rsquo;s use <a href=https://docs.gitlab.com/ee/ci/>Gitlab CI/CD</a> to automate the process of building my CV. There are some main benefits:</p><ol><li><p>I can update the LaTeX source everywhere and have Gitlab Runner build my CV without having a LaTeX environment.</p></li><li><p>I want to have a record of my CV releases.</p></li></ol><h2 id=strategy>Strategy<a hidden class=anchor aria-hidden=true href=#strategy>#</a></h2><p>Let&rsquo;s get the idea rolling with a draft diagram:</p><p><img loading=lazy src=/cv-auto/diagram.jpeg alt=diagram></p><ol><li><p>After the source code is tagged, the pipeline is triggered. Each tag represents a release with format <code>&lt;date>-&lt;month>-&lt;semantic-version></code>. For example, <code>2022-03-2.2.13</code> means the CV version 2.2.13 is written in March 2022.</p></li><li><p>Gitlab Runner builds the CV in a LaTeX environment and outputs the PDF version in Gitlab&rsquo;s <a href=https://docs.gitlab.com/ee/ci/pipelines/job_artifacts.html>artifacts</a> directory.</p></li><li><p>Reading the <code>ARTIFACT_URL</code> environment variable from the build phase, Gitlab Runner creates a <a href=https://docs.gitlab.com/ee/user/project/releases/>release</a> pointing to my CV&rsquo;s URL.</p></li></ol><h2 id=code>Code<a hidden class=anchor aria-hidden=true href=#code>#</a></h2><p>Below is my sample <code>.gitlab-ci.yml</code> configuration:</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-yml data-lang=yml><span style=color:#f92672>stages</span>:
  - <span style=color:#ae81ff>build</span>
  - <span style=color:#ae81ff>release</span>

<span style=color:#f92672>build</span>:
  <span style=color:#f92672>stage</span>: <span style=color:#ae81ff>build</span>
  <span style=color:#f92672>image</span>: <span style=color:#e6db74>&#34;listx/texlive:2020&#34;</span>
  <span style=color:#f92672>script</span>:
    - <span style=color:#ae81ff>export THIS_MONTH=$(date +%Y_%m)</span>
    - <span style=color:#ae81ff>export OUT_CV=Pham_Hoang_Hiep_cv_${THIS_MONTH}_${CI_COMMIT_SHORT_SHA}</span> <span style=color:#75715e># NOTE [1]</span>
    - <span style=color:#ae81ff>pdflatex -file-line-error --jobname=${OUT_CV} cv/cv.tex</span>
    - <span style=color:#ae81ff>echo &#34;ARTIFACT_URL=${CI_PROJECT_URL}/-/jobs/${CI_JOB_ID}/artifacts/file/${OUT_CV}.pdf&#34; &gt;&gt; build.env</span> <span style=color:#75715e># NOTE [2]</span>
  <span style=color:#f92672>artifacts</span>:
    <span style=color:#f92672>paths</span>:
      - <span style=color:#e6db74>&#34;*.pdf&#34;</span>
    <span style=color:#f92672>reports</span>:
      <span style=color:#f92672>dotenv</span>: <span style=color:#ae81ff>build.env</span>
  <span style=color:#f92672>only</span>:
    - <span style=color:#ae81ff>tags</span>

<span style=color:#f92672>release</span>:
  <span style=color:#f92672>stage</span>: <span style=color:#ae81ff>release</span>
  <span style=color:#f92672>image</span>: <span style=color:#ae81ff>registry.gitlab.com/gitlab-org/release-cli:latest</span>
  <span style=color:#f92672>script</span>:
    - <span style=color:#ae81ff>echo &#34;Getting artifact from ${ARTIFACT_URL}&#34;</span>
  <span style=color:#f92672>needs</span>: <span style=color:#75715e># NOTE [2]</span>
    - <span style=color:#f92672>job</span>: <span style=color:#ae81ff>build</span>
      <span style=color:#f92672>artifacts</span>: <span style=color:#66d9ef>true</span>
  <span style=color:#f92672>release</span>:
    <span style=color:#f92672>name</span>: <span style=color:#e6db74>&#34;$CI_COMMIT_TAG&#34;</span>
    <span style=color:#f92672>description</span>: <span style=color:#e6db74>&#34;Created using release-cli.&#34;</span>
    <span style=color:#f92672>tag_name</span>: <span style=color:#e6db74>&#34;$CI_COMMIT_TAG&#34;</span>
    <span style=color:#f92672>assets</span>:
      <span style=color:#f92672>links</span>:
        - <span style=color:#f92672>name</span>: <span style=color:#e6db74>&#34;CV&#34;</span>
          <span style=color:#f92672>url</span>: <span style=color:#e6db74>&#34;${ARTIFACT_URL}&#34;</span> <span style=color:#75715e># NOTE [2]</span>
  <span style=color:#f92672>only</span>:
    - <span style=color:#ae81ff>tags</span>
</code></pre></div><p>Some important notes:</p><ol><li><p>Add some salts (e.g. my commit&rsquo;s SHA) to my generated CV in order not to make release URLs conflict. Reference: <a href=https://gitlab.com/gitlab-org/release-cli/-/issues/73>here</a>.</p></li><li><p>Pass the <code>ARTIFACT_URL</code> environment to the next stage (release). Otherwise release wouldn&rsquo;t be able to know the created artifact path.</p></li></ol><h2 id=result>Result<a hidden class=anchor aria-hidden=true href=#result>#</a></h2><p>And here is my result on the <em>Releases</em> page.</p><p><img loading=lazy src=/cv-auto/release.png alt=release></p><p>Do you see the shiny link to my CV in the <em>Other</em> section?</p><p>That&rsquo;s all folks! Now I should be back to job hunting instead of doing this.</p></div><footer class=post-footer></footer></article></main><footer class=footer><span>&copy; 2022 <a href=https://hiepph.github.io>hiepph</a></span>
<span>Powered by
<a href=https://gohugo.io/ rel="noopener noreferrer" target=_blank>Hugo</a> &
        <a href=https://git.io/hugopapermod rel=noopener target=_blank>PaperMod</a></span></footer><a href=#top aria-label="go to top" title="Go to Top (Alt + G)"><button class=top-link id=top-link type=button accesskey=g><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 12 6" fill="currentcolor"><path d="M12 6H0l6-6z"/></svg></button></a>
<script>let menu=document.getElementById('menu');menu.scrollLeft=localStorage.getItem("menu-scroll-position"),menu.onscroll=function(){localStorage.setItem("menu-scroll-position",menu.scrollLeft)},document.querySelectorAll('a[href^="#"]').forEach(a=>{a.addEventListener("click",function(b){b.preventDefault();var a=this.getAttribute("href").substr(1);window.matchMedia('(prefers-reduced-motion: reduce)').matches?document.querySelector(`[id='${decodeURIComponent(a)}']`).scrollIntoView():document.querySelector(`[id='${decodeURIComponent(a)}']`).scrollIntoView({behavior:"smooth"}),a==="top"?history.replaceState(null,null," "):history.pushState(null,null,`#${a}`)})})</script><script>var mybutton=document.getElementById("top-link");window.onscroll=function(){document.body.scrollTop>800||document.documentElement.scrollTop>800?(mybutton.style.visibility="visible",mybutton.style.opacity="1"):(mybutton.style.visibility="hidden",mybutton.style.opacity="0")}</script><script>document.getElementById("theme-toggle").addEventListener("click",()=>{document.body.className.includes("dark")?(document.body.classList.remove('dark'),localStorage.setItem("pref-theme",'light')):(document.body.classList.add('dark'),localStorage.setItem("pref-theme",'dark'))})</script></body></html>